{
  "embeds": [
    {
      "title": "⬆️ {{ item.item_type }} {% if changes|length == 1 %}{{ changes[0].type|title }} {% endif %}Upgraded",
      "description": "{% if item.item_type == 'Episode' %}**{{ item.series_name }}** S{{ '%02d'|format(item.season_number or 0) }}E{{ '%02d'|format(item.episode_number or 0) }}\n{{ item.name }}{% else %}**{{ item.name }}**{% if item.year %} ({{ item.year }}){% endif %}{% endif %}",
      "color": {{ color }},
      "fields": [
        {% for change in changes %}
        {
          "name": "{% if change.type == 'resolution' %}📐 Resolution Change{% elif change.type == 'codec' %}🎞️ Video Codec Change{% elif change.type == 'audio_codec' %}🔊 Audio Codec Change{% elif change.type == 'audio_channels' %}🔊 Audio Channels Change{% elif change.type == 'hdr_status' %}🌈 HDR Status Change{% elif change.type == 'file_size' %}💾 File Size Change{% elif change.type == 'provider_ids' %}🔗 Provider ID Change{% else %}🔄 {{ change.type|title }} Change{% endif %}",
          "value": "{% if change.type == 'resolution' %}{{ change.old_value or 'Unknown' }}p → **{{ change.new_value or 'Unknown' }}p**{% elif change.type == 'codec' %}{{ change.old_value or 'Unknown' }} → **{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_codec' %}{{ change.old_value or 'Unknown' }} → **{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_channels' %}{{ change.old_value or 0 }} ch → **{{ change.new_value or 0 }} ch**{% elif change.type == 'hdr_status' %}{{ change.old_value or 'SDR' }} → **{{ change.new_value or 'SDR' }}**{% elif change.type == 'file_size' %}File replaced{% else %}{{ change.description }}{% endif %}",
          "inline": {% if loop.index <= 3 %}true{% else %}false{% endif %}
        }{% if not loop.last %},{% endif %}
        {% endfor %}
        {% if changes|length <= 3 %}
        ,{
          "name": "📐 Current Quality",
          "value": "{% if item.video_height %}{{ item.video_height }}p{% else %}Unknown{% endif %}{% if item.video_range and item.video_range != 'SDR' %} {{ item.video_range }}{% endif %}",
          "inline": true
        }
        {% if item.video_codec %}
        ,{
          "name": "🎞️ Current Codec",
          "value": "{{ item.video_codec.upper() }}{% if item.video_profile %} ({{ item.video_profile }}){% endif %}",
          "inline": true
        }
        {% endif %}
        {% if item.audio_codec %}
        ,{
          "name": "🔊 Current Audio",
          "value": "{{ item.audio_codec.upper() }}{% if item.audio_channels %} {{ item.audio_channels }}.{% if item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}",
          "inline": true
        }
        {% endif %}
        {% endif %}
        {% if item.imdb_id or item.tmdb_id or item.tvdb_id %}
        ,{
          "name": "🔗 External Links",
          "value": "{% if item.imdb_id %}[IMDb](https://www.imdb.com/title/{{ item.imdb_id }}/){% endif %}{% if item.tmdb_id %}{% if item.imdb_id %} • {% endif %}[TMDb](https://www.themoviedb.org/{% if item.item_type == 'Movie' %}movie{% else %}tv{% endif %}/{{ item.tmdb_id }}){% endif %}{% if item.tvdb_id %}{% if item.imdb_id or item.tmdb_id %} • {% endif %}[TVDb](https://thetvdb.com/dereferrer/series/{{ item.tvdb_id }}){% endif %}",
          "inline": false
        }
        {% endif %}
      ],
      "thumbnail": {
        "url": "{{ jellyfin_url }}/Items/{{ item.item_id }}/Images/Primary?maxHeight=300&maxWidth=200"
      },
      "footer": {
        "text": "Updated in Jellyfin • {{ timestamp[:19] | replace('T', ' ') }} UTC",
        "icon_url": "{{ jellyfin_url }}/web/favicon.ico"
      },
      "timestamp": "{{ timestamp }}"
    }
  ]
}