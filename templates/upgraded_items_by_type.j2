{
  "embeds": [
    {% if category == 'movies' %}
    {
      "title": "🎬⬆️ Movies Upgraded ({{ total_items }})",
      "description": "The following movies have been upgraded in Jellyfin:",
      "color": 16766720,
      "fields": [
        {% for item_data in upgraded_items[:6] %}
        {
          "name": "{{ item_data.item.name }}{% if item_data.item.year %} ({{ item_data.item.year }}){% endif %}",
          "value": "{% if item_data.item.overview and item_data.item.overview|length > 0 %}*{{ (item_data.item.overview[:120] + '...') if item_data.item.overview|length > 120 else item_data.item.overview }}*\n{% endif %}📐 {{ item_data.item.video_height or 'Unknown' }}p{% if item_data.item.video_range and item_data.item.video_range != 'SDR' %} {{ item_data.item.video_range }}{% endif %}{% if item_data.item.video_codec %} • 🎞️ {{ item_data.item.video_codec.upper() }}{% if item_data.item.video_profile %} ({{ item_data.item.video_profile }}){% endif %}{% endif %}{% if item_data.item.audio_codec %} • 🔊 {{ item_data.item.audio_codec.upper() }}{% if item_data.item.audio_channels %} {{ item_data.item.audio_channels }}.{% if item_data.item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}{% endif %}{% if item_data.item.runtime_ticks %} • ⏱️ {{ (item_data.item.runtime_ticks // 600000000) }}m{% endif %}{% if item_data.item.official_rating %} • 🏷️ {{ item_data.item.official_rating }}{% endif %}{% if item_data.changes|length > 0 %}\n\n**🔄 Upgrades**: {% for change in item_data.changes[:3] %}{% if change.type == 'resolution' %}{{ change.old_value or 'Unknown' }}p→**{{ change.new_value or 'Unknown' }}p**{% elif change.type == 'codec' %}{{ change.old_value or 'Unknown' }}→**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_codec' %}Audio: {{ change.old_value or 'Unknown' }}→**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_channels' %}{{ change.old_value or 0 }}ch→**{{ change.new_value or 0 }}ch**{% elif change.type == 'hdr_status' %}{{ change.old_value or 'SDR' }}→**{{ change.new_value or 'SDR' }}**{% elif change.type == 'file_size' %}File replaced{% else %}{{ change.description }}{% endif %}{% if not loop.last %} • {% endif %}{% endfor %}{% if item_data.changes|length > 3 %} +{{ item_data.changes|length - 3 }} more{% endif %}{% endif %}{% if item_data.ratings and item_data.ratings|length > 0 %}\n⭐ {% for rating_key, rating_data in item_data.ratings.items() %}{% if rating_key == 'imdb' %}**IMDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% elif rating_key == 'rotten_tomatoes' %}**RT**: {{ rating_data.value }}%{% elif rating_key == 'metacritic' %}**MC**: {{ rating_data.value }}/{{ rating_data.scale }}{% elif rating_key == 'tmdb' %}**TMDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% if rating_data.vote_count %} ({{ rating_data.vote_count }} votes){% endif %}{% endif %}{% if not loop.last %} • {% endif %}{% endfor %}{% endif %}{% if item_data.item.genres and item_data.item.genres|length > 0 %}\n🎭 {{ item_data.item.genres[:3]|join(', ') }}{% if item_data.item.genres|length > 3 %} +{{ item_data.item.genres|length - 3 }} more{% endif %}{% endif %}{% if item_data.item.imdb_id or item_data.item.tmdb_id or item_data.item.tvdb_id %}\n🔗 {% if item_data.item.imdb_id %}[IMDb](https://www.imdb.com/title/{{ item_data.item.imdb_id }}/){% endif %}{% if item_data.item.tmdb_id %}{% if item_data.item.imdb_id %} • {% endif %}[TMDb](https://www.themoviedb.org/movie/{{ item_data.item.tmdb_id }}){% endif %}{% if item_data.item.tvdb_id %}{% if item_data.item.imdb_id or item_data.item.tmdb_id %} • {% endif %}{% if item_data.ratings and item_data.ratings.tvdb and item_data.ratings.tvdb.proper_url %}[TVDb]({{ item_data.ratings.tvdb.proper_url }}){% else %}[TVDb](https://thetvdb.com/dereferrer/series/{{ item_data.item.tvdb_id }}){% endif %}{% endif %}{% endif %}",
          "inline": false
        }{% if not loop.last %},{% endif %}
        {% endfor %}
        {% if upgraded_items|length > 6 %}
        ,{
          "name": "⬆️ Additional Movie Upgrades",
          "value": "...and {{ upgraded_items|length - 6 }} more movies were upgraded.",
          "inline": false
        }
        {% endif %}
      ],
      "thumbnail": {
        "url": "{{ jellyfin_url }}/web/assets/img/banner-light.png"
      },
      "footer": {
        "text": "Updated in Jellyfin • {{ timestamp[:19] | replace('T', ' ') }} UTC{% if tvdb_attribution_needed %}\nMetadata provided by TheTVDB{% endif %}",
        "icon_url": "{{ jellyfin_url }}/web/favicon.ico"
      },
      "timestamp": "{{ timestamp }}"
    }
    {% elif category == 'tv' %}
    {
      "title": "📺⬆️ TV Episodes Upgraded ({{ total_items }})",
      "description": "The following TV episodes have been upgraded in Jellyfin:",
      "color": 16766720,
      "fields": [
        {% for item_data in upgraded_items[:8] %}
        {
          "name": "{{ item_data.item.series_name }} S{{ '%02d'|format(item_data.item.season_number or 0) }}E{{ '%02d'|format(item_data.item.episode_number or 0) }}",
          "value": "**{{ item_data.item.name }}**{% if item_data.item.overview and item_data.item.overview|length > 0 %}\n*{{ (item_data.item.overview[:100] + '...') if item_data.item.overview|length > 100 else item_data.item.overview }}*{% endif %}\n📐 {{ item_data.item.video_height or 'Unknown' }}p{% if item_data.item.video_range and item_data.item.video_range != 'SDR' %} {{ item_data.item.video_range }}{% endif %}{% if item_data.item.video_codec %} • 🎞️ {{ item_data.item.video_codec.upper() }}{% endif %}{% if item_data.item.audio_codec %} • 🔊 {{ item_data.item.audio_codec.upper() }}{% if item_data.item.audio_channels %} {{ item_data.item.audio_channels }}.{% if item_data.item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}{% endif %}{% if item_data.item.runtime_ticks %} • ⏱️ {{ (item_data.item.runtime_ticks // 600000000) }}m{% endif %}{% if item_data.item.premiere_date %} • 📅 {{ item_data.item.premiere_date[:10] }}{% endif %}{% if item_data.changes|length > 0 %}\n\n**🔄 Upgrades**: {% for change in item_data.changes[:2] %}{% if change.type == 'resolution' %}{{ change.old_value or 'Unknown' }}p→**{{ change.new_value or 'Unknown' }}p**{% elif change.type == 'codec' %}{{ change.old_value or 'Unknown' }}→**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_codec' %}Audio: {{ change.old_value or 'Unknown' }}→**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_channels' %}{{ change.old_value or 0 }}ch→**{{ change.new_value or 0 }}ch**{% elif change.type == 'hdr_status' %}{{ change.old_value or 'SDR' }}→**{{ change.new_value or 'SDR' }}**{% else %}{{ change.description }}{% endif %}{% if not loop.last %} • {% endif %}{% endfor %}{% if item_data.changes|length > 2 %} +{{ item_data.changes|length - 2 }} more{% endif %}{% endif %}{% if item_data.ratings and item_data.ratings|length > 0 %}\n⭐ {% for rating_key, rating_data in item_data.ratings.items() %}{% if rating_key == 'imdb' %}**IMDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% elif rating_key == 'tvdb' %}**TVDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% elif rating_key == 'tmdb' %}**TMDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% endif %}{% if not loop.last %} • {% endif %}{% endfor %}{% endif %}{% if item_data.item.imdb_id or item_data.item.tmdb_id or item_data.item.tvdb_id %}\n🔗 {% if item_data.item.imdb_id %}[IMDb](https://www.imdb.com/title/{{ item_data.item.imdb_id }}/){% endif %}{% if item_data.item.tmdb_id %}{% if item_data.item.imdb_id %} • {% endif %}[TMDb](https://www.themoviedb.org/tv/{{ item_data.item.tmdb_id }}){% endif %}{% if item_data.item.tvdb_id %}{% if item_data.item.imdb_id or item_data.item.tmdb_id %} • {% endif %}{% if item_data.ratings and item_data.ratings.tvdb and item_data.ratings.tvdb.proper_url %}[TVDb]({{ item_data.ratings.tvdb.proper_url }}){% else %}[TVDb](https://thetvdb.com/episodes/{{ item_data.item.tvdb_id }}){% endif %}{% endif %}{% endif %}",
          "inline": false
        }{% if not loop.last %},{% endif %}
        {% endfor %}
        {% if upgraded_items|length > 8 %}
        ,{
          "name": "⬆️ Additional Episode Upgrades",
          "value": "...and {{ upgraded_items|length - 8 }} more episodes were upgraded.",
          "inline": false
        }
        {% endif %}
      ],
      "thumbnail": {
        "url": "{{ jellyfin_url }}/web/assets/img/banner-light.png"
      },
      "footer": {
        "text": "Updated in Jellyfin • {{ timestamp[:19] | replace('T', ' ') }} UTC{% if tvdb_attribution_needed %}\nMetadata provided by TheTVDB{% endif %}",
        "icon_url": "{{ jellyfin_url }}/web/favicon.ico"
      },
      "timestamp": "{{ timestamp }}"
    }
    {% elif category == 'music' %}
    {
      "title": "🎵⬆️ Music Upgraded ({{ total_items }})",
      "description": "The following music has been upgraded in Jellyfin:",
      "color": 16766720,
      "fields": [
        {% for item_data in upgraded_items[:10] %}
        {
          "name": "{{ item_data.item.name }}{% if item_data.item.album %} • {{ item_data.item.album }}{% endif %}",
          "value": "{% if item_data.item.artists and item_data.item.artists|length > 0 %}🎤 **Artists**: {{ item_data.item.artists[:2]|join(', ') }}{% if item_data.item.artists|length > 2 %} +{{ item_data.item.artists|length - 2 }} more{% endif %}\n{% endif %}🔊 {{ item_data.item.audio_codec.upper() or 'Unknown' }}{% if item_data.item.audio_channels %} {{ item_data.item.audio_channels }}.{% if item_data.item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}{% if item_data.item.audio_bitrate %} • {{ (item_data.item.audio_bitrate / 1000)|int }} kbps{% endif %}{% if item_data.item.runtime_ticks %} • ⏱️ {{ (item_data.item.runtime_ticks // 600000000) }}m{% endif %}{% if item_data.changes|length > 0 %}\n\n**🔄 Upgrades**: {% for change in item_data.changes %}{% if change.type == 'audio_codec' %}{{ change.old_value or 'Unknown' }}→**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_channels' %}{{ change.old_value or 0 }}ch→**{{ change.new_value or 0 }}ch**{% elif change.type == 'file_size' %}File replaced{% else %}{{ change.description }}{% endif %}{% if not loop.last %} • {% endif %}{% endfor %}{% endif %}",
          "inline": true
        }{% if not loop.last %},{% endif %}
        {% endfor %}
        {% if upgraded_items|length > 10 %}
        ,{
          "name": "⬆️ Additional Music Upgrades",
          "value": "...and {{ upgraded_items|length - 10 }} more tracks were upgraded.",
          "inline": false
        }
        {% endif %}
      ],
      "thumbnail": {
        "url": "{{ jellyfin_url }}/web/assets/img/banner-light.png"
      },
      "footer": {
        "text": "Updated in Jellyfin • {{ timestamp[:19] | replace('T', ' ') }} UTC{% if tvdb_attribution_needed %}\nMetadata provided by TheTVDB{% endif %}",
        "icon_url": "{{ jellyfin_url }}/web/favicon.ico"
      },
      "timestamp": "{{ timestamp }}"
    }
    {% else %}
    {
      "title": "⬆️ Items Upgraded ({{ total_items }})",
      "description": "The following items have been upgraded in Jellyfin:",
      "color": 16766720,
      "fields": [
        {% for item_data in upgraded_items[:8] %}
        {
          "name": "{{ item_data.item.name }}{% if item_data.item.item_type %} ({{ item_data.item.item_type }}){% endif %}",
          "value": "{% if item_data.item.video_height %}📐 {{ item_data.item.video_height }}p{% if item_data.item.video_range and item_data.item.video_range != 'SDR' %} {{ item_data.item.video_range }}{% endif %}{% endif %}{% if item_data.item.video_codec %} • 🎞️ {{ item_data.item.video_codec.upper() }}{% endif %}{% if item_data.item.audio_codec %} • 🔊 {{ item_data.item.audio_codec.upper() }}{% if item_data.item.audio_channels %} {{ item_data.item.audio_channels }}.{% if item_data.item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}{% endif %}{% if item_data.changes|length > 0 %}\n\n**🔄 Upgrades**: {% for change in item_data.changes[:2] %}{% if change.type == 'resolution' %}{{ change.old_value or 'Unknown' }}p→**{{ change.new_value or 'Unknown' }}p**{% elif change.type == 'codec' %}{{ change.old_value or 'Unknown' }}→**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_codec' %}Audio: {{ change.old_value or 'Unknown' }}→**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_channels' %}{{ change.old_value or 0 }}ch→**{{ change.new_value or 0 }}ch**{% elif change.type == 'hdr_status' %}{{ change.old_value or 'SDR' }}→**{{ change.new_value or 'SDR' }}**{% else %}{{ change.description }}{% endif %}{% if not loop.last %} • {% endif %}{% endfor %}{% if item_data.changes|length > 2 %} +{{ item_data.changes|length - 2 }} more{% endif %}{% endif %}{% if item_data.ratings and item_data.ratings|length > 0 %}\n⭐ {% for rating_key, rating_data in item_data.ratings.items() %}{% if rating_key == 'imdb' %}**IMDb**: {{ rating_data.value }}{% elif rating_key == 'tmdb' %}**TMDb**: {{ rating_data.value }}{% endif %}{% if not loop.last %} • {% endif %}{% endfor %}{% endif %}{% if item_data.item.imdb_id or item_data.item.tmdb_id or item_data.item.tvdb_id %}\n🔗 {% if item_data.item.imdb_id %}[IMDb](https://www.imdb.com/title/{{ item_data.item.imdb_id }}/){% endif %}{% if item_data.item.tmdb_id %}{% if item_data.item.imdb_id %} • {% endif %}[TMDb](https://www.themoviedb.org/{% if item_data.item.item_type == 'Movie' %}movie{% elif item_data.item.item_type == 'Series' %}tv{% else %}tv{% endif %}/{{ item_data.item.tmdb_id }}){% endif %}{% if item_data.item.tvdb_id %}{% if item_data.item.imdb_id or item_data.item.tmdb_id %} • {% endif %}{% if item_data.ratings and item_data.ratings.tvdb and item_data.ratings.tvdb.proper_url %}[TVDb]({{ item_data.ratings.tvdb.proper_url }}){% elif item_data.item.item_type == 'Episode' %}[TVDb](https://thetvdb.com/episodes/{{ item_data.item.tvdb_id }}){% elif item_data.item.item_type == 'Series' %}[TVDb](https://thetvdb.com/series/{{ item_data.item.tvdb_id }}){% else %}[TVDb](https://thetvdb.com/dereferrer/series/{{ item_data.item.tvdb_id }}){% endif %}{% endif %}{% endif %}",
          "inline": false
        }{% if not loop.last %},{% endif %}
        {% endfor %}
        {% if upgraded_items|length > 8 %}
        ,{
          "name": "⬆️ Additional Upgrades",
          "value": "...and {{ upgraded_items|length - 8 }} more items were upgraded.",
          "inline": false
        }
        {% endif %}
      ],
      "thumbnail": {
        "url": "{{ jellyfin_url }}/web/assets/img/banner-light.png"
      },
      "footer": {
        "text": "Updated in Jellyfin • {{ timestamp[:19] | replace('T', ' ') }} UTC{% if tvdb_attribution_needed %}\nMetadata provided by TheTVDB{% endif %}",
        "icon_url": "{{ jellyfin_url }}/web/favicon.ico"
      },
      "timestamp": "{{ timestamp }}"
    }
    {% endif %}
  ]
}