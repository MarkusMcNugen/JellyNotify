{#
  Upgraded Item Compact Template for Jellynouncer
  ================================================

  Minimal upgrade notification showing only essential changes.
  Perfect for users who want brief upgrade notifications.

  Shows: Title, primary change, new quality
  Omits: Detailed metadata, multiple ratings, full change list
#}
{
  "embeds": [
    {
      "title": "⬆️ {{ item.item_type }} Upgraded",

      {#
        Simplified Description
        ----------------------
        Just the title and main upgrade info
      #}
      "description": "{% if item.item_type == 'Episode' -%}
        **{{ item.series_name }}** - {{ item.name }}
      {%- else -%}
        **{{ item.name }}**
        {%- if item.year %} ({{ item.year }}){% endif -%}
      {%- endif %}",

      "color": {{ color }},

      "fields": [
        {% set fields_added = namespace(count=0) %}

        {#
          Show only the primary upgrade
        #}
        {% if changes and changes | length > 0 %}
          {% set primary_change = changes[0] %}
          {% set fields_added.count = fields_added.count + 1 %}
        {
          "name": "🔄 Upgraded",
          "value": "{{ primary_change.old_value or 'Unknown' }} → **{{ primary_change.new_value or 'Unknown' }}**
            {%- if changes | length > 1 %} (+{{ changes | length - 1 }} more){% endif %}",
          "inline": true
        }
        {% endif %}

        {% if item.video_height %}
          {% if fields_added.count > 0 %},{% endif %}
        {
          "name": "📐 New Quality",
          "value": "{{ item.video_height }}p
            {%- if item.video_range and item.video_range != 'SDR' %} {{ item.video_range }}{% endif %}",
          "inline": true
        }
        {% endif %}
      ],

      "timestamp": "{{ timestamp }}"
    }
  ]
}