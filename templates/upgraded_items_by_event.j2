{
  "embeds": [
    {
      "title": "‚¨ÜÔ∏è Items Upgraded ({{ total_items }})",
      "description": "The following items have been upgraded in Jellyfin:",
      "color": 16766720,
      "fields": [
        {% for item_data in items[:8] %}
        {
          "name": "{% if item_data.item.item_type == 'Episode' %}üì∫ {{ item_data.item.series_name }} S{{ '%02d'|format(item_data.item.season_number or 0) }}E{{ '%02d'|format(item_data.item.episode_number or 0) }}{% elif item_data.item.item_type == 'Movie' %}üé¨ {{ item_data.item.name }}{% if item_data.item.year %} ({{ item_data.item.year }}){% endif %}{% elif item_data.item.item_type == 'Audio' or item_data.item.item_type == 'MusicAlbum' %}üéµ {{ item_data.item.name }}{% if item_data.item.album %} ‚Ä¢ {{ item_data.item.album }}{% endif %}{% else %}üìÅ {{ item_data.item.name }}{% endif %}",
          "value": "{% if item_data.item.item_type == 'Episode' %}**{{ item_data.item.name }}**{% if item_data.item.overview and item_data.item.overview|length > 0 %}\n*{{ (item_data.item.overview[:100] + '...') if item_data.item.overview|length > 100 else item_data.item.overview }}*{% endif %}\n{% elif item_data.item.item_type == 'Audio' or item_data.item.item_type == 'MusicAlbum' %}{% if item_data.item.artists and item_data.item.artists|length > 0 %}üé§ {{ item_data.item.artists[:2]|join(', ') }}{% if item_data.item.artists|length > 2 %} +{{ item_data.item.artists|length - 2 }} more{% endif %}\n{% endif %}{% elif item_data.item.overview and item_data.item.overview|length > 0 %}*{{ (item_data.item.overview[:120] + '...') if item_data.item.overview|length > 120 else item_data.item.overview }}*\n{% endif %}{% if item_data.item.video_height %}üìê {{ item_data.item.video_height }}p{% if item_data.item.video_range and item_data.item.video_range != 'SDR' %} {{ item_data.item.video_range }}{% endif %}{% endif %}{% if item_data.item.video_codec %} ‚Ä¢ üéûÔ∏è {{ item_data.item.video_codec.upper() }}{% endif %}{% if item_data.item.audio_codec %} ‚Ä¢ üîä {{ item_data.item.audio_codec.upper() }}{% if item_data.item.audio_channels %} {{ item_data.item.audio_channels }}.{% if item_data.item.audio_channels > 2 %}1{% else %}0{% endif %}{% endif %}{% endif %}{% if item_data.item.audio_bitrate and item_data.item.item_type in ['Audio', 'MusicAlbum'] %} ‚Ä¢ {{ (item_data.item.audio_bitrate / 1000)|int }} kbps{% endif %}{% if item_data.item.runtime_ticks %} ‚Ä¢ ‚è±Ô∏è {{ (item_data.item.runtime_ticks // 600000000) }}m{% endif %}{% if item_data.item.official_rating %} ‚Ä¢ üè∑Ô∏è {{ item_data.item.official_rating }}{% endif %}{% if item_data.item.premiere_date and item_data.item.item_type == 'Episode' %} ‚Ä¢ üìÖ {{ item_data.item.premiere_date[:10] }}{% endif %}{% if item_data.changes|length > 0 %}\n\n**üîÑ Upgrades**: {% for change in item_data.changes[:2] %}{% if change.type == 'resolution' %}{{ change.old_value or 'Unknown' }}p‚Üí**{{ change.new_value or 'Unknown' }}p**{% elif change.type == 'codec' %}{{ change.old_value or 'Unknown' }}‚Üí**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_codec' %}Audio: {{ change.old_value or 'Unknown' }}‚Üí**{{ change.new_value or 'Unknown' }}**{% elif change.type == 'audio_channels' %}{{ change.old_value or 0 }}ch‚Üí**{{ change.new_value or 0 }}ch**{% elif change.type == 'hdr_status' %}{{ change.old_value or 'SDR' }}‚Üí**{{ change.new_value or 'SDR' }}**{% elif change.type == 'file_size' %}File replaced{% else %}{{ change.description }}{% endif %}{% if not loop.last %} ‚Ä¢ {% endif %}{% endfor %}{% if item_data.changes|length > 2 %} +{{ item_data.changes|length - 2 }} more{% endif %}{% endif %}{% if item_data.ratings and item_data.ratings|length > 0 %}\n‚≠ê {% for rating_key, rating_data in item_data.ratings.items() %}{% if rating_key == 'imdb' %}**IMDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% elif rating_key == 'rotten_tomatoes' %}**RT**: {{ rating_data.value }}%{% elif rating_key == 'metacritic' %}**MC**: {{ rating_data.value }}/{{ rating_data.scale }}{% elif rating_key == 'tmdb' %}**TMDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% if rating_data.vote_count %} ({{ rating_data.vote_count }} votes){% endif %}{% elif rating_key == 'tvdb' %}**TVDb**: {{ rating_data.value }}/{{ rating_data.scale }}{% endif %}{% if not loop.last %} ‚Ä¢ {% endif %}{% endfor %}{% endif %}{% if item_data.item.genres and item_data.item.genres|length > 0 and item_data.item.item_type in ['Movie', 'Episode'] %}\nüé≠ {{ item_data.item.genres[:3]|join(', ') }}{% if item_data.item.genres|length > 3 %} +{{ item_data.item.genres|length - 3 }} more{% endif %}{% endif %}",
          "inline": false
        }{% if not loop.last %},{% endif %}
        {% endfor %}
        {% if items|length > 8 %}
        ,{
          "name": "‚¨ÜÔ∏è Additional Upgrades",
          "value": "...and {{ items|length - 8 }} more items were upgraded in Jellyfin.",
          "inline": false
        }
        {% endif %}
      ]{% set first_movie = items|selectattr('item.item_type', 'equalto', 'Movie')|first %}{% set first_series = items|selectattr('item.item_type', 'equalto', 'Series')|first %}{% set first_episode = items|selectattr('item.item_type', 'equalto', 'Episode')|first %}{% if first_movie or first_series or first_episode %},
      "thumbnail": {
        "url": "{% if first_movie %}{{ jellyfin_url }}/Items/{{ first_movie.item.item_id }}/Images/Primary?maxHeight=400&maxWidth=300{% elif first_series %}{{ jellyfin_url }}/Items/{{ first_series.item.item_id }}/Images/Primary?maxHeight=400&maxWidth=300{% elif first_episode and first_episode.item.series_id %}{{ jellyfin_url }}/Items/{{ first_episode.item.series_id }}/Images/Primary?maxHeight=400&maxWidth=300{% else %}{{ jellyfin_url }}/web/assets/img/banner-light.png{% endif %}"
      }{% endif %}{% if first_movie %},
      "image": {
        "url": "{{ jellyfin_url }}/Items/{{ first_movie.item.item_id }}/Images/Primary?maxHeight=400&maxWidth=300"
      }{% elif first_series %},
      "image": {
        "url": "{{ jellyfin_url }}/Items/{{ first_series.item.item_id }}/Images/Primary?maxHeight=400&maxWidth=300"
      }{% endif %},
      "footer": {
        "text": "Updated in Jellyfin ‚Ä¢ {{ timestamp[:19] | replace('T', ' ') }} UTC{% if tvdb_attribution_needed %}\nMetadata provided by TheTVDB{% endif %}",
        "icon_url": "{{ jellyfin_url }}/web/favicon.ico"
      },
      "timestamp": "{{ timestamp }}"
    }
  ]
}